function Agencycompany(){}Agencycompany.prototype={constructor:Agencycompany,throttle:function(e,n){clearTimeout(e.tId),e.tId=setTimeout(function(){e.call(n)},200)},touchThrottle:function(e,n,t){var a=null,o=new Date;return function(){var i=this,s=arguments,r=new Date;clearTimeout(a),r-o>=t?(e.apply(i,s),o=r):a=setTimeout(function(){e.apply(i,s)},n)}},getData:function(e,n,t,a){return 4!==arguments.length?($my.messageInfo.html("参数错误").fadeIn("fast").delay("1000").fadeOut("slow"),!1):null==e||"null"==e?($my.messageInfo.html("楼盘参数丢失").fadeIn("fast").delay("1000").fadeOut("slow"),!1):void $.ajax({url:getRoothPath+"/agencycompanycontroller/agencyCompanyListApp.json",data:{propertyId:e,column:n,dir:t,pageNum:a},success:function(e){if("{}"===JSON.stringify(e))return $my.loader_inner.hide(),$my.messageInfo.html("暂无信息").stop().fadeIn("fast").delay("1000").fadeOut("slow"),!1;$my.pageSize=e.recordsTotal;var n=e.data;if(!n.length)return $my.loader_inner.hide(),$my.messageInfo.html("暂无信息").stop().fadeIn("fast").delay("1000").fadeOut("slow"),!1;n.length<20&&($my.loader_inner.hide(),$my.lodingText.classList.add("lodingText_show")),agencycompany.renderElement(n)}})},renderElement:function(e){for(var n="",t=0;t<e.length;t++){var a=(e[t].ShouldCommission/1e4).toFixed(0);""==e[t].agencyName&&(e[t].agencyName="--"),n+="<div class='row' data-agencyid="+e[t].AgencyID+">",n+="<div class='col-sm-8 col-xs-8 col-md-8'>",n+="<div class='innerTop'>",n+="<p class='nowrap bigFont' data-toggle='tooltip' data-placement='top' title="+e[t].agencyName+">"+e[t].agencyName+"</p>",n+="</div>",n+="<div class='innerBottom'>",n+="<p class='colorGray'>佣:<span>"+a+"</span>万　　<span>--</span>套</p>",n+="</div>",n+="</div>",n+="<div class='col-sm-4 col-xs-4 col-md-4 text-right'>",n+="<div class='innerTop'>",n+="<p class='colorGray'><span>"+e[t].MemberCount+"</span>人</p>",n+="</div>",n+="<div class='innerBottom'>",n+="<kbd class='bgcGray'><span>联</span>:<span>"+e[t].PlaceUserName+"</span></kbd>",n+="</div>",n+="</div>",n+="</div>"}$my.ulList.append(n),$my.flag=!1},scrollEvent:function(){var e=document.documentElement.clientHeight,n=$my.lodingText.parentNode,t=n.getBoundingClientRect(),a=$my.dDAndDk.querySelector(".optionListActive").dataset.column,o=$my.dDAndDk.querySelector(".optionListActive").dataset.dir;if(!$my.flag){if(!(t.top<e&&t.bottom>=0))return;if($my.flag=!0,++$my.num>parseInt($my.pageSize/20)||$my.num==parseInt($my.pageSize/20)&&$my.pageSize%20==0)return $my.loader_inner.hide(),$my.lodingText.classList.add("lodingText_show"),!1;agencycompany.getData($my.propertyid,a,o,$my.num)}},buffer:function(){var e=this.dataset.column,n=this.dataset.dir;$my.lodingText.classList.remove("lodingText_show"),$my.loader_inner.show(),agencycompany.getData($my.propertyid,e,n,0)},dDAndDkEvent:function(){var e=dDAndDk.querySelectorAll("div");Array.prototype.forEach.call(e,function(e){e.addEventListener("touchend",function(e){e.preventDefault(),e.stopPropagation(),$(this).addClass("optionListActive").siblings("div").removeClass("optionListActive"),$my.num=0,$my.ulList.html(""),agencycompany.throttle(agencycompany.buffer,this)},!1)})},bindCompanyClick:function(){$my.ulList[0].addEventListener("click",function(e){var n,e=e||window.event,t=e.target||e.srcElement;if(-1!==t.className.indexOf("row")&&(n=t),t==this)return!1;for(;-1===t.className.indexOf("row");)t=t.parentNode,n=t;var a=n.dataset.agencyid;window.location.href="newChannel_detail.html?agencyid="+a,e.preventDefault(),e.stopPropagation()},!1)}};var agencycompany=new Agencycompany;$(function(){window.$my={messageInfo:$(".messageInfo"),propertyid:sessionStorage.getItem("propertyID"),ulList:$("#ulList"),num:0,dDAndDk:document.querySelector("#dDAndDk"),loader_inner:$(".loader-inner"),lodingText:document.querySelector(".lodingText"),flag:!1},$.ajaxSetup({type:"POST",dataType:"json",error:function(){$my.messageInfo.html("服务错误").fadeIn("fast").delay("1000").fadeOut("slow")}}),agencycompany.getData($my.propertyid,"SaleHouseCount","desc",0),window.addEventListener("touchmove",agencycompany.touchThrottle(agencycompany.scrollEvent,500,1e3)),agencycompany.dDAndDkEvent(),agencycompany.bindCompanyClick(),document.querySelector(".qdSearchBox").addEventListener("touchend",function(e){e.preventDefault(),e.stopPropagation(),window.location.href="search_list.html"},!1)});